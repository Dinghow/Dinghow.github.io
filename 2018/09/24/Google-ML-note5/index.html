<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Dinghow的个人博客">
    <meta name="keyword" content="">
    <meta name="theme-color" content="#600090">
    <meta name="msapplication-navbutton-color" content="#600090">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#600090">
    <link rel="shortcut icon" href="http://ouluvpd0z.bkt.clouddn.com/favicon.png">
    <link rel="alternate" type="application/atom+xml" title="Dinghow" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.css">
    <title>
        
        Google机器学习课程笔记part5：训练神经网络，多类别神经网络，嵌套｜Dinghow&#39;s blog
        
    </title>

    <link rel="canonical" href="http://dinghow.site/2018/09/24/Google-ML-note5/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/blog-style.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
</head>

<style>

    header.intro-header {
        background-image: url('http://ouluvpd0z.bkt.clouddn.com/habowangyuangjing_paishe_xingkong_yuzhou-016.jpg')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top " id="nav-top" data-ispost = "true" data-istags="false
" data-ishome = "false" >
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand animated pulse" href="/">
                <span class="brand-logo">
                    Dinghow
                </span>
                's Blog
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <!-- /.navbar-collapse -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
					
                    
                        
							
								
							
						
                    
                        
							
                        <li>
                            <a href="/archives/">archives</a>
                        </li>
							
						
                    
                        
							
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
							
						
                    
					
					
						<li>
							<a href="/about">About</a>
						</li>
					
                </ul>
            </div>
        </div>
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
//    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>

<!-- Main Content -->

<!--only post-->


<img class="wechat-title-img" src="http://ouluvpd0z.bkt.clouddn.com/google-ml-cover.png">


<style>
    
    header.intro-header {
        background-image: url('http://ouluvpd0z.bkt.clouddn.com/google-ml-cover.png');
    }

    
</style>

<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <div class="post-heading">
                    <h1>Google机器学习课程笔记part5：训练神经网络，多类别神经网络，嵌套</h1>
                    
                    <span class="meta">
                         作者 Dinghow
                        <span>
                          日期 2018-09-24
                         </span>
                    </span>
                    <div class="tags text-center">
                        
                        <a class="tag" href="/tags/#机器学习"
                           title="机器学习">机器学习</a>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="post-title-haojen">
        <span>
            Google机器学习课程笔记part5：训练神经网络，多类别神经网络，嵌套
        </span>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="col-lg-8 col-lg-offset-1 col-sm-9 post-container">
                <blockquote>
<h3 id="系列笔记索引："><a href="#系列笔记索引：" class="headerlink" title="系列笔记索引："></a>系列笔记索引：</h3><p><a href="https://developers.google.cn/machine-learning/crash-course/" target="_blank" rel="external">官方课程</a></p>
<p><a href="https://github.com/Dinghow/MyRoadToMachineLearning" target="_blank" rel="external">Github仓库</a></p>
<p><a href="https://dinghow.site/2018/03/25/Google-ML-note1/">Part1：基础概念，降低损失</a></p>
<p><a href="https://dinghow.site/2018/06/15/Google-ML-note2/">Part2：泛化，验证，表示法，特征组合</a></p>
<p><a href="https://dinghow.site/2018/09/03/Google-ML-note3/">Part3：L2正则化，逻辑回归，分类</a></p>
<p><a href="https://dinghow.site/2018/09/23/Google-ML-note4/">Part4：L1正则化，神经网络</a></p>
<p><a href="https://dinghow.site/2018/09/24/Google-ML-note5/">Part5：训练神经网络，多类别神经网络，嵌套</a></p>
</blockquote>
<h3 id="14-训练神经网络"><a href="#14-训练神经网络" class="headerlink" title="14. 训练神经网络"></a>14. 训练神经网络</h3><p>最常见的神经网络训练算法：<a href="https://google-developers.gonglchuangl.net/machine-learning/crash-course/backprop-scroll/" target="_blank" rel="external">反向传播算法</a>（BP算法，BackPropagation）</p>
<blockquote>
<p>是一种与<a href="https://zh.wikipedia.org/wiki/%E6%9C%80%E4%BC%98%E5%8C%96" target="_blank" rel="external">最优化方法</a>（如<a href="https://zh.wikipedia.org/wiki/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95" target="_blank" rel="external">梯度下降法</a>）结合使用的，用来训练<a href="https://zh.wikipedia.org/wiki/%E4%BA%BA%E5%B7%A5%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" target="_blank" rel="external">人工神经网络</a>的常见方法。该方法对网络中所有权重计算<a href="https://zh.wikipedia.org/w/index.php?title=%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0&amp;action=edit&amp;redlink=1" target="_blank" rel="external">损失函数</a>的梯度。这个梯度会反馈给最优化方法，用来更新权值以最小化损失函数。</p>
</blockquote>
<p>很多情况都会导致BP算法出错</p>
<ul>
<li><p>梯度消失：较低层（更接近输入）的梯度可能会变得非常小。在深度网络中，计算这些梯度时，可能涉及许多小项的乘积。当较低层的梯度逐渐消失到 0 时，这些层的训练速度会非常缓慢，甚至不再训练。</p>
<p>ReLU 激活函数有助于防止梯度消失。</p>
</li>
<li><p>梯度爆炸：如果网络中的权重过大，则较低层的梯度会涉及许多大项的乘积。在这种情况下，梯度就会爆炸：梯度过大导致难以收敛。</p>
<p>批标准化可以降低学习速率，因而有助于防止梯度爆炸。</p>
</li>
<li><p>ReLu单元消失：一旦 ReLU 单元的加权和低于 0，ReLU 单元就可能会停滞，梯度无法反向传播。由于梯度的来源被切断，ReLU 的输入可能无法作出足够的改变来使加权和恢复到 0 以上。</p>
<p>降低学习速率有助于防止 ReLU 单元消失。</p>
</li>
</ul>
<p>丢弃正则化</p>
<blockquote>
<p>一种形式的<a href="https://developers.google.cn/machine-learning/crash-course/glossary#regularization" target="_blank" rel="external"><strong>正则化</strong></a>，在训练<a href="https://developers.google.cn/machine-learning/crash-course/glossary#neural_network" target="_blank" rel="external"><strong>神经网络</strong></a>方面非常有用。丢弃正则化的运作机制是，在神经网络层的一个梯度步长中移除随机选择的固定数量的单元。丢弃的单元越多，正则化效果就越强。</p>
</blockquote>
<h3 id="15-多类别神经网络"><a href="#15-多类别神经网络" class="headerlink" title="15. 多类别神经网络"></a>15. 多类别神经网络</h3><h4 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h4><p>一对多提供了一种利用二元分类的方法，对于N个可行的解决方案，就包括N个单独的二元分类器</p>
<p><img src="https://github.com/Dinghow/MyRoadToMachineLearning/raw/master/note/img/google-10.png" alt=""></p>
<h4 id="Softmax"><a href="#Softmax" class="headerlink" title="Softmax"></a>Softmax</h4><blockquote>
<p>Softmax函数，又称为归一化函数，它能将一个含任意实数的K维向量 $Z$ “压缩”到另一个K维实向量 $\sigma(z)$中，使得每一个元素的范围都在之间$(0,1)$，并且所有元素的和为1。</p>
</blockquote>
<p>根据Softmax函数的这一特点，常常将其用多类别领域，Softmax为每个类别分配一个小数表示概率，其和为1</p>
<p>Softmax函数的表达式为：</p>
<p><img src="https://github.com/Dinghow/MyRoadToMachineLearning/raw/master/note/img/18.png" alt=""></p>
<p>而在神经网络中，Softmax层必须有和输出层一样的节点数</p>
<h4 id="Softmax的选项"><a href="#Softmax的选项" class="headerlink" title="Softmax的选项"></a>Softmax的选项</h4><ul>
<li>完整Softmax：针对所有类别都要计算概率</li>
<li>候选采样：针对正类别标签计算概率，针对负类别标签随机采样计算概率</li>
</ul>
<blockquote>
<p><strong>候选采样：</strong>在训练一个多类别分类器过程中，所有的类别都需要进行评估。为了解决这个问题，人们发明了候选采样的技巧，每次只评估所有类别的一个很小的子集。tensorflow包含了多种候选采样函数</p>
</blockquote>
<h4 id="Softmax不适用的情况"><a href="#Softmax不适用的情况" class="headerlink" title="Softmax不适用的情况"></a>Softmax不适用的情况</h4><p>对于每一个样本可能是多个类别的成员是，Softmax不适用，必须依赖于多个逻辑回归</p>
<h3 id="16-嵌套-Embedding"><a href="#16-嵌套-Embedding" class="headerlink" title="16. 嵌套(Embedding)"></a>16. 嵌套(Embedding)</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>一种分类特征，以连续值特征表示。通常，嵌套是指将高维度向量映射到低维度的空间。可以理解为数据降维，在数学上即表示一个mapping,f:X-&gt;Y，而Y的维度低于X。</p>
<p>例如，您可以采用以下两种方式之一来表示英文句子中的单词：</p>
<ul>
<li>表示成包含百万个元素（高维度）的<a href="https://developers.google.cn/machine-learning/glossary/#sparse_features" target="_blank" rel="external"><strong>稀疏向量</strong></a>，其中所有元素都是整数。向量中的每个单元格都表示一个单独的英文单词，单元格中的值表示相应单词在句子中出现的次数。由于单个英文句子包含的单词不太可能超过 50 个，因此向量中几乎每个单元格都包含 0。少数非 0 的单元格中将包含一个非常小的整数（通常为 1），该整数表示相应单词在句子中出现的次数。</li>
<li>表示成包含数百个元素（低维度）的<a href="https://developers.google.cn/machine-learning/glossary/#dense_feature" target="_blank" rel="external"><strong>密集向量</strong></a>，其中每个元素都存储一个介于 0 到 1 之间的浮点值。这就是一种嵌套。</li>
</ul>
</blockquote>
<h4 id="适用"><a href="#适用" class="headerlink" title="适用"></a>适用</h4><p>使用独热编码表示法时，产生的输入矢量可能会比较稀疏，会使得训练的数据量和计算量变得十分庞大，且矢量之间缺乏有意义的联系，在这种情况下，使用嵌套对数据进行降维可以很好地解决这个问题</p>
<h4 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h4><p>可以将嵌套作为目标任务的神经网络的一部分进行学习。如图所示，嵌套单元实际上就是大小为d（采用d维嵌套，即可以通过d维的矢量在d维空间下表示出一个样本）的一个特殊类型的隐藏单元。嵌入层只是一个隐藏层，无需单独的训练过程，像之前一样通过反向传播即可进行训练。</p>
<p><img src="https://github.com/Dinghow/MyRoadToMachineLearning/raw/master/note/img/google-11.png" alt=""></p>

                <!-- Go to www.addthis.com/dashboard to customize your tools --> <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b683f13817fa82e"></script>
                <hr>
                

                <ul class="pager">
                    
                    
                    <li class="next">
                        <a href="/2018/09/23/Google-ML-note4/" data-toggle="tooltip" data-placement="top"
                           title="Google机器学习课程笔记part4：L1正则化，神经网络">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                

                


                <!--加入新的评论系统-->
                
                <!-- 来必力City版安装代码 -->
                <div id="lv-container" data-id="city" data-uid="MTAyMC8zMDE1MS82NzA2">
                    <script type="text/javascript">
                        (function(d, s) {
                            var j, e = d.getElementsByTagName(s)[0];

                            if (typeof LivereTower === 'function') { return; }

                            j = d.createElement(s);
                            j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                            j.async = true;

                            e.parentNode.insertBefore(j, e);
                        })(document, 'script');
                    </script>
                    <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
                </div>
                <!-- City版安装代码已完成 -->
                
            </div>

            <div class="hidden-xs col-sm-3 toc-col">
                <div class="toc-wrap">
                    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#系列笔记索引："><span class="toc-text">系列笔记索引：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-训练神经网络"><span class="toc-text">14. 训练神经网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-多类别神经网络"><span class="toc-text">15. 多类别神经网络</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#一对多"><span class="toc-text">一对多</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Softmax"><span class="toc-text">Softmax</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Softmax的选项"><span class="toc-text">Softmax的选项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Softmax不适用的情况"><span class="toc-text">Softmax不适用的情况</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-嵌套-Embedding"><span class="toc-text">16. 嵌套(Embedding)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#定义"><span class="toc-text">定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#适用"><span class="toc-text">适用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#训练"><span class="toc-text">训练</span></a></li></ol></li></ol>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5 class="text-center">
                        <a href="/tags/">FEATURED TAGS</a>
                    </h5>
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#机器学习"
                           title="机器学习">机器学习</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <div style="margin-top: 20px;">
                    <h5 class="text-center">FRIENDS</h5>
                    <ul class="list-inline text-center">
                        
                        <li><a href="http://quanyulong.net/">Quanyu Long</a></li>
                        
                        <li><a href="https://lovesnowbest.site">loveSnowBest</a></li>
                        
                        <li><a href="https://www.zhouii.com">01的翼</a></li>
                        
                        <li><a href="http://npkho.me">Snogy</a></li>
                        
                        <li><a href="https://blog.csdn.net/qq_38265784">一世长安乱</a></li>
                        
                        <li><a href="http://www.foxerlee.top">Foxerlee</a></li>
                        
                        <li><a href="https://guitoubing.top">鬼王</a></li>
                        
                    </ul>
                </div>
                
            </div>
        </div>

    </div>
</article>







<!-- Footer -->
<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <br>
                <ul class="list-inline text-center">
                
                
                    <li>
                        <a target="_blank" href="https://twitter.com/Dinghow11">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/dinghow9">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/Dinghow">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Dinghow 2018
                    Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>
                    <br>
                    <span id="busuanzi_container_site_pv" style="font-size: 12px;">PV: <span id="busuanzi_value_site_pv"></span> Times</span>
                    <br>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/blog.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://dinghow.site/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>

<!-- Google Analytics -->



<!-- Baidu Tongji -->

<script>
    var _baId = 'cfc1f626a232642e2c231a7c376d7e72';
    // Originial
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?" + _baId;
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


<!-- swiftype -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','','2.0.0');
</script>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!--wechat title img-->
<img class="wechat-title-img" src="http://ouluvpd0z.bkt.clouddn.com/eru.png">
</body>

</html>
